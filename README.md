# ML-OpenCV-ObjectClassification

**TOOL SET:**

* macOS Mojave
* CMake and Make (Build Project)
* vsCode (Editor)
* lldb (Debug, https://code.visualstudio.com/docs/cpp/config-clang-mac)
* OpenCV 4.1 + (QT Support) https://github.com/opencv/opencv

# Description 

This is a basic implementation of objects classification using Machine learning tools provided by opencv. This project apply supervised learning with Support Vector Machine(SVM) model. The data to train our model is in img folder. 

An overview of the steps followed by the code are the next ones:

* Preprocess the image
* Extract the features and then add the features to the training feature vector with a corresponding label.
* Create an SVM model.
* Train our SVM model with the training feature vector.

After we have our model trained:
* Preprocess the input image to classify each segmented object.
* Segment the input image.

For each Object detected: 
* Extract the features
* Predict it with the SVM
* Paint the result in the output image


There are some important things to notice here:

* /vscode is a folder generated by vsCode to set up the debug functionality.Also has a c_cpp_properties.json to help the intellÂ¡sense to find the headers. Make sure you set up these files according with your directories. (https://code.visualstudio.com/docs/cpp/c-cpp-properties-schema-reference)
* CMakeLists.txt used to build the project. Notice i build from source the OpenCV library.

for more information on how to build from source: https://www.learnopencv.com/install-opencv-4-on-macos/

# Steps to run

On Project folder :

```sh
$ mkdir build && cd build
$ cmake ..
$ make
$ ./ObjectDetection <image dir> <light pattern> // for this particular case ./ObjectDetection ../img/test_noise.pgm ../img/light.pgm
```
**Note:** CommandLineParser is used to read the input, there are some optional parameters in program execution, from better understanding refer to : https://docs.opencv.org/3.4/d0/d2e/classcv_1_1CommandLineParser.html

To specify all input parameteres should be like this: 
```sh
./ObjectClassification ../img/test.pgm ../img/pattern.pgm
```
Expected Output 

![Image Prediction ](https://github.com/ederfduran/ML-OpenCV-ObjectClassification/blob/master/img/Output.jpg)
